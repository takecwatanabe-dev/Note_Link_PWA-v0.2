/* Note Link UI — single CSS file
   v0.6.8 / No.12  （cache bust例：.../note-link-ui.css?v=0.6.8-No.12）
============================================================== */

/* ---------- Theme tokens ---------- */
:root{
  --bg:#0f172a;          /* app background */
  --stage:#0b1220;       /* canvas周り */
  --panel:#111827;       /* パネル&サイドバー */
  --ink:#e5e7eb;         /* 文字色 */
  --muted:#374151;       /* 枠線/セパレータ */
  --accent:#50C878;      /* アクティブ緑 */
  --accent-soft: color-mix(in srgb, var(--accent) 50%, transparent);

  --tool:40px;           /* アイコンの基準サイズ（△含む） */
  --radius:12px;         /* 角丸の基準 */
  --pad:8px;             /* サイドバー内の余白 */
  --gap:8px;             /* サイドバー内の間隔 */
  --topbar-h:36px;       /* 上部メニューの高さ */
  --shadow: 0 0 0 0 rgba(0,0,0,0);
}

/* ---------- Base ---------- */
*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ color-scheme: dark; }
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP",
               "Hiragino Kaku Gothic ProN", "Yu Gothic", "Meiryo", sans-serif;
  overflow:hidden;
}

/* ---------- Top bar (ページ移動/保存/共有など) ---------- */
header, .topbar{
  height:var(--topbar-h);
  display:flex; align-items:center; gap:8px;
  padding:0 10px;
  border-bottom:1px solid var(--muted);
  background:var(--panel);
}
header .brand{ display:flex; align-items:center; gap:8px; font-weight:700; }
header .actions, .topbar{ margin-left:auto; display:flex; gap:6px; }
header button, .topbar button{
  height:28px; padding:0 8px;
  display:inline-flex; align-items:center; justify-content:center;
  border:1px solid var(--muted); border-radius:10px;
  background:#0b1220; color:var(--ink);
  line-height:28px;    /* ← 文字の上下ズレ解消 */
}
header button:hover, .topbar button:hover{ border-color:var(--accent); }

/* ページャ */
.pager{ display:flex; align-items:center; gap:6px; }
.pager .count{ min-width:56px; text-align:center; font-variant-numeric: tabular-nums; }

/* ---------- Layout ---------- */
.wrap{
  display:grid;
  grid-template-columns: calc(var(--tool) + var(--pad)*2) 1fr;
  grid-template-rows: 1fr;
  height: calc(100% - var(--topbar-h));
}
/* 横方向の折り畳み時（最小幅＝アイコン1列ぶん） */
.wrap.collapsedX{
  grid-template-columns: calc(var(--tool) + var(--pad)*2) 1fr !important;
}

/* ---------- Sidebar (tools) ---------- */
.sidebar{
  background:var(--panel);
  border-right:1px solid var(--muted);
  padding:var(--pad);
  display:flex; flex-direction:column; align-items:center;
  gap:var(--gap);
  overflow:visible;
}
.sidebar .group{ width:100%; display:flex; flex-direction:column; align-items:center; gap:6px; }

.toggleBar{
  /* △/▽トグル — ツールと同じサイズで静的配置（重なり対策） */
  position:static !important;
  width:var(--tool); height:var(--tool);
  display:grid; place-items:center;
  background:#0b1220; color:var(--ink);
  border:1px solid var(--muted); border-radius:var(--radius);
  cursor:pointer; user-select:none;
}
.toggleBar:hover{ border-color:var(--accent); }
.toggleBar.active{
  outline:2px solid var(--accent);
  box-shadow:0 0 12px var(--accent-soft);
}

/* tool buttons */
.tool{
  width:var(--tool); height:var(--tool);
  display:grid; place-items:center;
  background:#0b1220; color:var(--ink);
  border:1px solid var(--muted); border-radius:var(--radius);
  cursor:pointer; user-select:none;
  transition:border-color .15s ease, box-shadow .15s ease;
}
.tool img, .tool svg{ width:18px; height:18px; filter:grayscale(1) brightness(1.05); }
.tool:hover{ border-color:var(--accent); }
.tool.active{
  outline:2px solid var(--accent);
  box-shadow:0 0 14px var(--accent-soft);
}
.tool.active img, .tool.active svg{ filter:none; }

/* 小さめのラベル（必要なら） */
.tool-label{ font-size:10px; opacity:.8; }

/* 縦方向の折り畳み（サイドバーの背丈を抑える） */
.sidebar.collapsedY{
  max-height: calc(var(--tool) + var(--pad)*2);
  overflow:hidden;
}

/* ---------- Stage / Canvas ---------- */
.stage{ position:relative; background:var(--stage); }
canvas{ display:block; width:100%; height:100%; background:transparent; }

.pageIndicator{ position:absolute; top:8px; right:8px; opacity:.6; display:none; }

/* ---------- Settings flyout (ギアのパネル) ---------- */
.flyout{
  position:absolute; top:72px; left:72px;
  width:360px; max-width:90vw; max-height:70vh; overflow:auto;
  background:rgba(17,24,39,.98);
  border:1px solid var(--muted); border-radius:14px;
  box-shadow:0 10px 32px rgba(0,0,0,.45);
  padding:12px;
  backdrop-filter: blur(6px);
  z-index:10;
}
.flyout.hidden{ display:none; }

.flyoutHeader{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px; }
.flyoutHeader .title{ font-weight:700; }

.closeX{
  width:28px; height:28px;
  display:grid; place-items:center;
  border:1px solid var(--muted); border-radius:8px;
  background:#0b1220; color:var(--ink);
}

.tabbar{ display:flex; gap:6px; margin-bottom:6px; flex-wrap:wrap; }
.tabbar button{
  height:28px; padding:0 8px;
  border:1px solid var(--muted); border-radius:8px;
  background:#0b1220; color:var(--ink); line-height:28px;
}
.tabbar button.active{ border-color:var(--accent); background:#10212f; }

/* 設定フォーム内の共通 */
.panel h3{ margin:6px 0 10px; font-size:14px; }
.row{ display:flex; gap:8px; align-items:center; margin-bottom:8px; flex-wrap:wrap; }
.row input[type="range"]{ width:160px; }
.hint{ font-size:12px; opacity:.75; line-height:1.4; }

/* カラースウォッチ（背景色など） */
.swatch{ width:22px; height:22px; border-radius:6px; border:1px solid #64748b; cursor:pointer; }
.swatchRow{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }

/* テキスト入力（キャンバス上の編集用） */
.textInput{
  position:absolute; background:#ffffff; color:#111827;
  border:1px solid #94a3b8; border-radius:6px; padding:4px 6px; min-width:120px; outline:none;
}

/* ---------- Misc ---------- */
/* 上部メニューのボタン文字の縦位置ズレ/高さ統一（フォールバック用） */
button{ font:inherit; }

/* 印刷時：キャンバスだけ出力（必要に応じて） */
@media print{
  body{ margin:0; }
  header, .sidebar, .flyout{ display:none !important; }
  .wrap{ grid-template-columns: 1fr !important; }
}

/* 小画面の微調整 */
@media (max-width:640px){
  :root{ --tool:36px; }
  .flyout{ left:16px; right:16px; width:auto; }
}
