<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8" />
<title>Note Link v0.6.7 / No.11</title>
<style>
:root{--bg:#0f172a;--panel:#111827;--ink:#e5e7eb;--accent:#50C878;--muted:#374151;}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;overflow:hidden}

/* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆæ–‡å­—ã‚ºãƒ¬å¯¾ç­–ï¼šè¡Œé«˜å›ºå®šï¼‹ä¸­å¤®å¯„ã›ï¼‰ */
header{height:48px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;background:var(--panel);border-bottom:1px solid var(--muted)}
.brand{font-weight:700}
.ver{font-size:12px;margin-left:6px;padding:2px 8px;border:1px solid var(--muted);border-radius:10px;opacity:.9}
.actions{display:flex;gap:6px;align-items:center}
.actions button{display:inline-flex;align-items:center;justify-content:center;height:32px;line-height:32px;padding:0 10px;border:1px solid var(--muted);border-radius:8px;background:#0b1220;color:var(--ink);cursor:pointer}
.actions button:hover{border-color:var(--accent)}

/* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
.wrap{display:grid;grid-template-columns:60px 1fr;height:calc(100% - 48px)}
.wrap.collapsedX{grid-template-columns:28px 1fr}
.sidebar{position:relative;background:var(--panel);border-right:1px solid var(--muted)}
/* ãƒˆã‚°ãƒ«ã¯å¸¸ã«å·¦ä¸Šã€‚ãƒ„ãƒ¼ãƒ«ã¨ã¯åˆ¥ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã—ã¦ z-index ã‚’ä¸Šã’ã‚‹ */
.toggleBar{position:absolute;top:8px;left:8px;width:40px;height:40px;border-radius:12px;display:grid;place-items:center;background:#0b1220;border:1px solid var(--muted);cursor:pointer;z-index:5}
/* ãƒ„ãƒ¼ãƒ«åˆ—ã¯ãƒˆã‚°ãƒ«åˆ†ã®ä½™ç™½ã‚’å¿…ãšç¢ºä¿ï¼ˆé‡ãªã‚Šé˜²æ­¢ï¼‰ */
.tools{padding:56px 8px 8px 8px;display:flex;flex-direction:column;gap:8px}

/* ãƒ„ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */
.toolGroup{display:flex;flex-direction:column;align-items:center;gap:4px}
.tool{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;background:#0b1220;border:1px solid var(--muted);cursor:pointer;transition:box-shadow .15s,border-color .15s}
.tool.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(80,200,120,.55),0 0 12px rgba(80,200,120,.45)}
/* è¨­å®šã‚®ã‚¢ã¯ç´°ç·šã€‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã®ã¿ç´°ã„ã‚°ãƒ­ãƒ¼ */
.gear{width:26px;height:26px;border-radius:8px;display:grid;place-items:center;border:1px solid var(--muted);opacity:.9}
.gear.active{border-color:var(--accent);box-shadow:0 0 0 1px rgba(80,200,120,.5)}

/* æŠ˜ã‚ŠãŸãŸã¿ï¼ˆç¸¦ï¼‰ï¼šé«˜ã•åˆ¶é™ã ã‘ã€‚æ¨ªã¯wrapå´ã§å¹…ã‚’ç´°ãã™ã‚‹ */
.sidebar.collapsedY{max-height:44px;overflow:hidden}
.stage{background:#0b1220;position:relative}
canvas{display:block;width:100%;height:100%;background:transparent}
</style>
</head>
<body>
<header>
  <div class="brand">Note Link <span class="ver">v0.6.7 / No.11</span></div>
  <div class="actions">
    <button id="btnPrev">â—€</button>
    <span id="pageLabel">1 / 1</span>
    <button id="btnNext">â–¶</button>
    <button id="btnPrint">å°åˆ·</button>
    <button id="btnPNG">PNG</button>
    <button id="btnSave">ä¿å­˜(JSON)</button>
    <button id="btnLoad">èª­è¾¼(JSON)</button>
    <button id="btnShare">å…±æœ‰</button>
  </div>
</header>

<div class="wrap" id="wrap">
  <aside class="sidebar" id="sidebar">
    <div class="toggleBar" id="toggleBar">â–³</div>
    <div class="tools">
      <div class="toolGroup"><div class="tool" id="toolPen" title="ãƒšãƒ³">âœ</div><div class="gear" id="gearPen" title="ãƒšãƒ³è¨­å®š">âš™</div></div>
      <div class="toolGroup"><div class="tool" id="toolHL" title="è›å…‰">ğŸ–</div><div class="gear" id="gearHL">âš™</div></div>
      <div class="toolGroup"><div class="tool" id="toolEraser" title="æ¶ˆã—ã‚´ãƒ ">âŒ«</div><div class="gear" id="gearEraser">âš™</div></div>
      <div class="toolGroup"><div class="tool" id="toolPan" title="ç§»å‹•">ğŸ–</div><div class="gear" id="gearPan">âš™</div></div>
      <div class="toolGroup"><div class="tool" id="toolText" title="ãƒ†ã‚­ã‚¹ãƒˆ">âŒ¨</div><div class="gear" id="gearText">âš™</div></div>
      <div class="toolGroup"><div class="tool" id="toolBg" title="èƒŒæ™¯">ğŸ¨</div><div class="gear" id="gearBg">âš™</div></div>
    </div>
  </aside>
  <main class="stage"><canvas id="canvas"></canvas></main>
</div>

<script>
/* æŠ˜ã‚ŠãŸãŸã¿ï¼šâ–³/â–½ã¨ãƒ„ãƒ¼ãƒ«ãŒé‡ãªã‚‰ãªã„ã‚ˆã†ã«ã€toolsã«å›ºå®šã®ä¸Šä½™ç™½ã‚’ç¢ºä¿æ¸ˆã¿ */
const wrap = document.getElementById('wrap');
const sidebar = document.getElementById('sidebar');
const toggleBar = document.getElementById('toggleBar');
toggleBar.addEventListener('click', ()=>{
  sidebar.classList.toggle('collapsedY');
  wrap.classList.toggle('collapsedX');
  toggleBar.textContent = sidebar.classList.contains('collapsedY') ? 'â–½' : 'â–³';
});

/* ãƒ„ãƒ¼ãƒ«é¸æŠï¼šã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã«å¤ªã‚ã®ç·‘ã‚°ãƒ­ãƒ¼å¾©å¸°ï¼‹ã‚®ã‚¢ã¯ç´°ã‚°ãƒ­ãƒ¼ */
const tools = [...document.querySelectorAll('.tool')];
const gears = [...document.querySelectorAll('.gear')];
function setActiveTool(el){
  tools.forEach(t=>t.classList.remove('active'));
  el.classList.add('active');
  // ã‚®ã‚¢ã¯ãã®ãƒ„ãƒ¼ãƒ«ã ã‘ç´°ã‚°ãƒ­ãƒ¼
  gears.forEach(g=>g.classList.remove('active'));
  const pair = el.parentElement.querySelector('.gear');
  pair?.classList.add('active');
}
tools.forEach(t=>t.addEventListener('click',()=>setActiveTool(t)));
setActiveTool(document.getElementById('toolPen')); // åˆæœŸã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚’ãƒšãƒ³

/* ã‚­ãƒ£ãƒ³ãƒã‚¹ï¼ˆæœ€ä½é™ï¼šã‚µã‚¤ã‚ºåˆã‚ã›ã®ã¿ï¼‰ */
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const dpr = Math.max(1, window.devicePixelRatio||1);
function fit(){ const r = canvas.parentElement.getBoundingClientRect(); canvas.width = Math.floor(r.width*dpr); canvas.height = Math.floor(r.height*dpr); ctx.setTransform(dpr,0,0,dpr,0,0); }
addEventListener('resize', fit); fit();

/* å…±æœ‰/å°åˆ·/PNGï¼ˆèƒŒæ™¯è¾¼ã¿ï¼‰ */
document.getElementById('btnPrint').onclick=()=>window.print();
document.getElementById('btnPNG').onclick=()=>{ const a=document.createElement('a'); a.download='note.png'; a.href=canvas.toDataURL('image/png'); a.click(); };
document.getElementById('btnShare').onclick=async()=>{
  const url=location.href;
  if(navigator.share){ try{ await navigator.share({title:'Note Link',url}); }catch{} }
  else{ await navigator.clipboard.writeText(url); alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'); }
};

/* JSON ä¿å­˜/èª­è¾¼ï¼ˆç°¡æ˜“ãƒ»ãƒ€ãƒŸãƒ¼ï¼‰ */
document.getElementById('btnSave').onclick=()=>{
  const blob=new Blob([JSON.stringify({pages:[{strokes:[]}]} ,null,2)],{type:'application/json'});
  const a=document.createElement('a'); a.download='note-link.json'; a.href=URL.createObjectURL(blob); a.click(); URL.revokeObjectURL(a.href);
};
document.getElementById('btnLoad').onclick=()=>{
  const i=document.createElement('input'); i.type='file'; i.accept='application/json';
  i.onchange=e=>{ const f=e.target.files[0]; if(!f) return; f.text().then(()=>alert('JSONã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼ˆãƒ€ãƒŸãƒ¼ï¼‰')); };
  i.click();
};
</script>
</body></html>
