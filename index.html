/* Note Link UI stylesheet
   version: v0.6.9-fix3 / No.13
   purpose : toolbar sizing, spacing, collapse arrow, active glow
   author  : ChatGPT
*/

/* ===== Theme tokens ===== */
:root{
  --ink:#e5f2eb;         /* 文字・アイコン */
  --bg:#0b1020;          /* 背景 */
  --muted:#27324a;       /* 枠線 */
  --accent:#58c67b;      /* アクティブの緑 */
  --accent-weak:rgba(65,205,130,.25);
  --shadow0:0 0 0 1px rgba(0,0,0,.25), 0 6px 18px rgba(0,0,0,.35);
  --topbar-h: 44px;      /* 上部メニューの高さ（環境で微調整OK） */
}

/* ===== Reset-ish ===== */
html,body{height:100%}
html{background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Yu Gothic",Meiryo,sans-serif;}
*,*::before,*::after{box-sizing:border-box}
button{font:inherit; background:none; border:none; color:inherit;}

/* ===== 上部ボタン群（既存） ===== */
header .actions button, .topbar button, .topbar .btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:6px; height:30px; padding:0 8px; border-radius:10px;
  background:rgba(255,255,255,.05); color:var(--ink); border:1px solid var(--muted);
}
.topbar button:active{ transform:translateY(1px); }

/* ===== キャンバス領域が下にずれないように ===== */
#wrapper, #wrap{height:100%}

/* ===== サイドバー（ツールバー） ===== */
#sidebar{
  position:fixed; left:0; top:var(--topbar-h); bottom:0;
  width:66px; padding:6px; border-right:1px solid var(--muted);
  display:flex; flex-direction:column; gap:8px;
  background:rgba(0,0,0,.0); z-index:20;
}

/* 折りたたみ時の幅 */
#sidebar[data-collapsed="1"]{ width:44px; }

/* ツールボタンの基本 */
#sidebar .tool{
  width:42px; height:42px; border-radius:12px;
  display:grid; place-items:center; cursor:pointer;
  border:1px solid var(--muted);
  background:rgba(255,255,255,.03);
  transition:background .15s ease, box-shadow .15s ease, outline .15s ease;
}
#sidebar .tool:hover{ background:rgba(255,255,255,.07); }
#sidebar .tool svg{ width:20px; height:20px; filter:grayscale(1) brightness(1.0); }

/* アクティブなツール（太めの緑グロー：前の見た目に復帰） */
#sidebar .tool.active{
  outline:2px solid var(--accent);
  box-shadow:
    0 0 0 2px var(--accent-weak),
    0 0 14px var(--accent-weak);
}

/* 一番上の△▽（折りたたみボタン）は常に先頭、重ならない */
#collapseBtn{ order:0; }

/* 設定ボタンは一番下に固定（他のツールと重ならない） */
#settingsBtn{ margin-top:auto; }

/* 折りたたみ時はボタンを少しだけ小さくして当たり判定を保つ */
#sidebar[data-collapsed="1"] .tool{ width:38px; height:38px; }

/* 折りたたみアイコンの向き（data-collapsedで反転） */
#collapseBtn .chev{ transition:transform .15s ease; }
#sidebar[data-collapsed="1"] #collapseBtn .chev{ transform:rotate(180deg); }

/* 左端のガター（ノート表示に干渉しないよう細く保つ） */
body::before{
  content:""; position:fixed; left:66px; top:var(--topbar-h); bottom:0; width:0; pointer-events:none;
}
#sidebar[data-collapsed="1"] ~ body::before{ left:44px; }

/* ===== パネル（設定/ペン/蛍光/消しゴム/テキスト）の共通 ===== */
.settings-panel,.pen-panel,.marker-panel,.eraser-panel,.text-panel{
  position:absolute; left:84px; top:calc(var(--topbar-h) + 12px);
  min-width:260px; padding:12px; border-radius:12px;
  background:rgba(12,18,32,.92); border:1px solid var(--muted); color:var(--ink);
  box-shadow:var(--shadow0); backdrop-filter:saturate(1.2) blur(2px);
}
.settings-panel[hidden],
.pen-panel[hidden],
.marker-panel[hidden],
.eraser-panel[hidden],
.text-panel[hidden]{ display:none !important; }

/* スライダー等の細かい整形（見やすく） */
.panel-row{ display:flex; align-items:center; gap:10px; margin:8px 0; }
.panel-row .label{ min-width:64px; opacity:.85; }
.panel-row input[type="range"]{ width:160px; }
.panel-actions{ display:flex; gap:8px; justify-content:flex-end; }

